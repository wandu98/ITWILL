<!DOCTYPE html>
<html lang="ko">                 
    <head>      
        <meta charset="UTF-8">                 
        <title>04_계산기.html</title> 
        <style>
            .txt{
                border: 2px solid #ccffff;
                text-align: right;
                font-weight: bold;
                font-size: 20px;
                color: black;
                height: 30px;
                background-color: #e0ebeb;
            }
        </style>
    </head>
    <body>                       

        <h3>미니 계산기</h3>

        <form>
            <table border="1"> 
            <tr>
                <td colspan="4">
                    <input type="text" name="result" id="result" size="20" value="0" readonly class="txt">
                </td>
            </tr>
            <tr>
                
                <td><input type="button" value="    7    " onclick="inputData(7)"></td>
                <td><input type="button" value="    8    " onclick="inputData(8)"></td>
                <td><input type="button" value="    9    " onclick="inputData(9)"></td>
                <td><input type="button" value="    ➗   " onclick="operator('/')" ></td>
            </tr>
            <tr>
                
                <td><input type="button" value="    4    " onclick="inputData(4)"></td>
                <td><input type="button" value="    5    " onclick="inputData(5)"></td>
                <td><input type="button" value="    6    " onclick="inputData(6)"></td>
                <td><input type="button" value="    ✖️    " onclick="operator('*')"></td>
            </tr>
            <tr>
                <td><input type="button" value="    1    " onclick="inputData(1)"></td>
                <td><input type="button" value="    2    " onclick="inputData(2)"></td>
                <td><input type="button" value="    3    " onclick="inputData(3)"></td>
                <td><input type="button" value="    ➖   " onclick="operator('-')"></td>
            </tr>
            <tr>
                <td><input type="button" value="    0    " onclick="inputData(0)"></td>
                <td><input type="button" value="    .    "></td>
                <td><input type="button" value="    🟰   " onclick="compute()"></td>
                <td><input type="button" value="    ➕   " onclick="operator('+')"></td>
            </tr>
            <tr>
                <td colspan="2">
                    <input type="button" value="    🔚   " onclick="backspace()">
                </td>
                <td colspan="2">
                    <input type="button" value="    C   " onclick="cls()">
                </td>
            </tr>
            </table>
        </form>

        
        <script>
            //1) C 버튼을 클릭하면 id=result에 0을 대입
            function cls(){
                document.getElementById("result").value = 0;
            }//cls() end

            //2) 클릭한 숫자 버튼에 맞는 숫자를 출력하기
            function inputData(su){
                //alert(su);
                //전달받은 su변수값을 id=result에 대입
                //document.getElementById("result").value += su;

                //id=result값을 숫자형으로 변환("0123"->123)
                document.getElementById("result").value = Number(document.getElementById("result").value += su);
            }//inputData() end

            //3 연산에 필요한 전역변수 선언하기
            let op;     //연산기호
            let num1;   //사용자 입력한 첫번째 수
            let num2;   //사용자 입력한 두번째 수
            
            function operator(kind){
                //4)클릭한 연산기호를 전역변수 op에 저장하기
                //alert(kind);
                op=kind;

                //5)현재 id=result가 가지고 있는 값을 num1에 저장하기
                num1=Number(document.getElementById("result").value);

                //6)두번째 수를 입력받기 위해 id=result값을 초기화하기
                cls();

            }//operator() end

            //참조 https://www.w3schools.com/jsref/jsref_eval.asp
            function compute(){
                //실제 계산을 해서 결과값 출력하기
                //7)계산에 필요한 두번째 수를 nm2에 저장하기
                num2=Number(document.getElementById("result").value);

                //8)계산해서 결과 출력하기
                document.getElementById("result").value = eval(num1 + op + num2);

            }//compute() end

            //9) 🔚 버튼을 클릭하면 id=result값에서 마지막 글자부터 순서대로 지우기
            //  id=result값에서 마지막 글자만 제외시키고 다시 대입
            //  단, 자릿수가 한개인 값은 0으로 대입
            function backspace(){
                //let cv = document.getElementById("result").value; 
                //document.getElementById("result").value = cv.slice(0, cv.length-1);
                
                //a)id=result값을 가져와서 글자갯수 출력하기
                let result=document.getElementById("result").value;
                //alert(result);
                //alert(result.length);

                //b)처음글자부터 마지막 글자를 제외시키고 문자열 가져오기(substring()) 중요함수
                let len=result.length;
                //alert(result.substring(0, len-1));

                //c)분리된 b)문자열을 다시 id=result에 대입하기
                //  단, 글자갯수가 1개이면  0으로 다시 대입
                if(len==1){
                    document.getElementById("result").value=0;
                }else{
                    document.getElementById("result").value=result.substring(0, len-1)
                }//if end

                }//backspace() end
        </script>
        
    </body>                      
</html>